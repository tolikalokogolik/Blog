mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13)) +
xlim(c(-1, 35)) +
ylab("Average price") +
xlab("Year")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
xlim(c(-1, 35)) +
ylab("Average price") +
xlab("Year")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
xlim(c(-0.5, 35)) +
ylab("Average price") +
xlab("Year")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
xlim(c(0, 35)) +
ylab("Average price") +
xlab("Year")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
xlim(c(1, 35)) +
ylab("Average price") +
xlab("Year")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
xlim(c(1, 35)) +
scale_x_continuous(position = "top", expand = expansion(mult = c(0, 0.05))) +
coord_capped_cart(top = 'both') +
ylab("Average price") +
xlab("Year")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
xlim(c(0, 35)) +
scale_x_continuous(position = "top", expand = expansion(mult = c(0, 0.05))) +
coord_capped_cart(top = 'both') +
ylab("Average price") +
xlab("Year")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
xlim(c(0, 35)) +
scale_x_continuous(position = "top", expand = expansion(mult = c(0, 0.05))) +
coord_capped_cart(top = 'both') +
ylab("Average price") +
xlab("Year")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
xlim(c(0, 35)) +
scale_x_continuous(position = "top", )) +
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
xlim(c(0, 35)) +
scale_x_continuous(position = "top" )) +
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
xlim(c(0, 35)) +
scale_x_continuous(position = "top" ) +
coord_capped_cart(top = 'both') +
ylab("Average price") +
xlab("Year")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
xlim(c(1, 35)) +
scale_x_continuous(position = "top" ) +
coord_capped_cart(top = 'both') +
ylab("Average price") +
xlab("Year")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
xlim(c(1, 35)) +
scale_x_continuous(position = "top" ) +
coord_capped_cart(top = 'both') +
ylab("Average price") +
xlab("Day")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
xlim(c(1, 40)) +
scale_x_continuous(position = "top" ) +
coord_capped_cart(top = 'both') +
ylab("Average price") +
xlab("Day")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
scale_x_continuous(position = "top", limits = c(1, 40)) +
coord_capped_cart(top = 'both') +
ylab("Average price") +
xlab("Day")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
scale_x_continuous(position = "top", limits = c(1, 35)) +
coord_capped_cart(top = 'both') +
ylab("Average price") +
xlab("Day")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
scale_x_continuous(position = "top", limits = c(1, 35)) +
coord_capped_cart(top = 'both') +
ylab("Average births") +
xlab("Day")
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
scale_x_continuous(position = "top", limits = c(1, 35)) +
coord_capped_cart(top = 'both') +
ylab("Average births") +
xlab("Day") +
ggtitle("Average births in months", subtitle = "End and start of the year has lowest average births")
load("employee.Rdata")
ui = fluidPage(
fluidRow(
column(
width = 4,
checkboxGroupInput(
"martial_status",
p("Select martial status"),
choices = list(
"Single" = "Single",
"Married" = "Married",
"Divorced" = "Divorced"
),
selected = c("Divorced","Married","Single")
),
checkboxGroupInput(
"gender",
p("Select gender"),
choices = list(
"Female" = "Female",
"Male" = "Male"
),
selected = c("Female","Male")
)
),
column(
width = 4,
sliderInput(
"income",
"Income per capita filter",
min = min(employee$MonthlyIncome),
max = max(employee$MonthlyIncome),
value = c(min(employee$MonthlyIncome), max(employee$MonthlyIncome))
),
sliderInput(
"age",
"Age filter",
min = min(employee$Age),
max = max(employee$Age),
value = c(min(employee$Age), max(employee$Age))
)
),
column(
width = 4,
selectInput(
"color",
p("Background color"),
choices = list(
"Grey" = 1,
"White" = 2
),
selected = 1
)
)
),
hr(),
tabsetPanel(
tabPanel(
"Birthrate and life expectancy",
plotOutput("plot")
),
tabPanel(
"Birthrate and income class",
plotOutput("plot2")
)
)
)
server = function(input, output) {
output$plot = renderPlot({
data <- employee %>%
filter(MaritalStatus %in% input$martial_status,
MonthlyIncome >= input$income[1],
MonthlyIncome <= input$income[2],
Age >= input$age[1],
Age <= input$age[2],
Gender %in% input$gender)
plot <- data %>%
ggplot(aes(x = MonthlyIncome, y = Age, color = MaritalStatus, shape=Gender)) +
geom_point()
if (input$color == 1){
plot = plot + theme_gray()
} else {
plot = plot + theme_bw()
}
plot
})
output$plot2 = renderPlot({
data <- employee %>%
filter(MaritalStatus %in% input$martial_status,
MonthlyIncome >= input$income[1],
MonthlyIncome <= input$income[2],
Age >= input$age[1],
Age <= input$age[2],
Gender %in% input$gender)
plot <- data %>%
ggplot(aes(x = JobRole, y = MonthlyIncome)) +
geom_boxplot()
if (input$color == 1){
plot = plot + theme_gray()
} else {
plot = plot + theme_bw()
}
plot
})
}
# Run the app ----
shinyApp(ui = ui, server = server)
load("theme.R")
GRAY1 = "#231F20"
GRAY2 = "#414040"
GRAY3 = "#555655"
GRAY4 = "#646369"
GRAY5 = "#76787B"
GRAY6 = "#828282"
GRAY7 = "#929497"
GRAY8 = "#A6A6A5"
GRAY9 = "#BFBEBE"
BLUE1 = "#174A7E"
BLUE2 = "#4A81BF"
BLUE3 = "#94B2D7"
BLUE4 = "#94AFC5"
BLUE5 = "#22435e"
BLUE6 = "#95B3D7"
RED1 = "#C3514E"
RED2 = "#E6BAB7"
RED3 = "#800000"
GREEN1 = "#0C8040"
GREEN2 = "#9ABB59"
GREEN3 = "#31859C"
GREEN4 = "#4BACC6"
GREEN5 = "#93CDDD"
ORANGE1 = "#F79747"
ORANGE2 = "#FAC090"
theme_swd <- function() {
theme_minimal(base_size = 11, base_family = "Helvetica") +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(size = .13, color = GRAY9),
axis.text = element_text(color = GRAY7),
axis.ticks.x = element_line(size = 0.5, color = GRAY9),
axis.ticks.y = element_line(size = 0.5, color = GRAY9),
axis.title = element_text(color = GRAY3),
axis.title.y = element_text(hjust = 1, margin = margin(0, 6, 0, 15, "pt")),
axis.title.x = element_text(hjust = 0, margin = margin(6, 0, 15, 0, "pt")),
plot.subtitle = element_text(color = GRAY4, size= 11),
plot.title = element_text(color = GRAY4, size= 15),
plot.title.position = "plot", # This aligns the plot title to the very left edge
plot.caption = element_text(hjust = 0, color = GRAY6),
plot.caption.position = "plot",
plot.margin = margin(.5,.5,.5,.5,"cm"),
strip.text = element_text(color = GRAY7))
}
load("theme.R")
GRAY1 = "#231F20"
GRAY2 = "#414040"
GRAY3 = "#555655"
GRAY4 = "#646369"
GRAY5 = "#76787B"
GRAY6 = "#828282"
GRAY7 = "#929497"
GRAY8 = "#A6A6A5"
GRAY9 = "#BFBEBE"
BLUE1 = "#174A7E"
BLUE2 = "#4A81BF"
BLUE3 = "#94B2D7"
BLUE4 = "#94AFC5"
BLUE5 = "#22435e"
BLUE6 = "#95B3D7"
RED1 = "#C3514E"
RED2 = "#E6BAB7"
RED3 = "#800000"
GREEN1 = "#0C8040"
GREEN2 = "#9ABB59"
GREEN3 = "#31859C"
GREEN4 = "#4BACC6"
GREEN5 = "#93CDDD"
ORANGE1 = "#F79747"
ORANGE2 = "#FAC090"
theme_swd <- function() {
theme_minimal(base_size = 11, base_family = "Helvetica") +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(size = .13, color = GRAY9),
axis.text = element_text(color = GRAY7),
axis.ticks.x = element_line(size = 0.5, color = GRAY9),
axis.ticks.y = element_line(size = 0.5, color = GRAY9),
axis.title = element_text(color = GRAY3),
axis.title.y = element_text(hjust = 1, margin = margin(0, 6, 0, 15, "pt")),
axis.title.x = element_text(hjust = 0, margin = margin(6, 0, 15, 0, "pt")),
plot.subtitle = element_text(color = GRAY4, size= 11),
plot.title = element_text(color = GRAY4, size= 15),
plot.title.position = "plot", # This aligns the plot title to the very left edge
plot.caption = element_text(hjust = 0, color = GRAY6),
plot.caption.position = "plot",
plot.margin = margin(.5,.5,.5,.5,"cm"),
strip.text = element_text(color = GRAY7))
}
#load("theme.R")
load("births_year.Rdata")
labels <- births_year %>%
filter(AverageBirths < 9000)
labels2 <- births_year %>%
group_by(Month) %>%
filter(Month %in% c(1,12),
DayOfMonth == max(DayOfMonth)) %>%
mutate(Month = case_when(Month==1 ~ "January",
T ~ "December"))
births_year %>%
mutate(varv = case_when(Month == 12 ~ RED3,
Month == 1 ~ RED1,
Month == 7 ~ RED2,
T ~ GRAY9)) %>%
ggplot(aes(x=DayOfMonth,y=AverageBirths, group = Month, color=varv)) +
geom_line() +
scale_colour_identity() +
geom_text(aes(label = round(AverageBirths)), color = GRAY4, vjust = 1.5, hjust=0.5, nudge_y = 15, data = labels) +
geom_text(aes(label = Month), color = GRAY4, vjust = 0.5, hjust=-0.1, nudge_y = 15, data = labels2) +
theme_swd() +
ylim(c(6300, 13000)) +
scale_x_continuous(position = "top", limits = c(1, 35)) +
coord_capped_cart(top = 'both') +
ylab("Average births") +
xlab("Day") +
ggtitle("Average births in months", subtitle = "End and start of the year has lowest average births")
